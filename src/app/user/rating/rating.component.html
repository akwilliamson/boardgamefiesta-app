<div class="container" *ngIf="user$ | async as user">
  <h1>{{user.username}}</h1>

  <a [routerLink]="['/user', user.id]">
    View activity
  </a>

  <h2>Ratings for {{'game.' + (gameId$ | async) + '.name' | translate}}</h2>

  <ngx-charts-line-chart
    [view]="[800, 400]"
    [scheme]="{domain:['#ff0000']}"
    [legend]="false"
    [showXAxisLabel]="true"
    [showYAxisLabel]="false"
    [xAxis]="true"
    [yAxis]="true"
    [xAxisLabel]="'Time'"
    [xAxisTickFormatting]="dateTickFormatting"
    [yAxisLabel]="'Rating'"
    [yAxisTickFormatting]="numberTickFormatting(locale)"
    [timeline]="true"
    [results]="chartData$ | async"
    [animations]="false">
  </ngx-charts-line-chart>

  <table class="table">
    <thead>
    <tr>
      <th>Date</th>
      <th>Rating</th>
    </tr>
    </thead>
    <tbody>
    <tr *ngFor="let rating of ratings$ | async">
      <td>
        <a [routerLink]="['/',rating.gameId, rating.tableId]">
          {{rating.timestamp | date:'long'}}
        </a>
      </td>
      <td>
        <ng-template #ratingDetailsPopover>
          <user-rating-details [userId]="rating.userId"
                               [tableId]="rating.tableId"></user-rating-details>
        </ng-template>
        <app-rating [rating]="rating.rating"
                    [ngbPopover]="ratingDetailsPopover"
                    triggers="mouseenter"
                    autoClose="outside"
                    container="body">>
        </app-rating>
      </td>
    </tr>
    </tbody>
  </table>
</div>
